{% extends 'clubs/base.html' %}

{% block title %}{{ club.name }} - MatchFeeMate{% endblock %}

{% block content %}
<!-- Club heading and details -->
<div class="d-flex justify-content-between align-items-center mb-3">
    <h1>{{ club.name }}</h1>
    <!-- Club action buttons -->
    <div>
        <a href="{% url 'club_update' pk=club.pk %}" class="btn btn-mfm-secondary btn-sm">Edit</a>
        <a href="{% url 'club_delete' pk=club.pk %}" class="btn btn-mfm-danger btn-sm">Delete</a>
    </div>
</div>

<!-- Club info card -->
<div class="card card-mfm mb-4">
    <div class="card-body">
        <p class="mb-1"><strong>Home Ground:</strong> {{ club.home_ground|default:"Not set" }}</p>
        <p class="mb-1"><strong>Default Match Fee:</strong> Â£{{ club.default_match_fee }}</p>
        <p class="mb-0"><strong>Created by:</strong> {{ club.created_by.email }}</p>
    </div>
</div>

<!-- Players section -->
<div class="d-flex justify-content-between align-items-center mb-2">
    <h2>Players</h2>
    <a href="{% url 'player_create' club_pk=club.pk %}" class="btn btn-mfm-primary btn-sm">Add Player</a>
</div>

{% if club.players.all %}
    {% for player in club.players.all %}
    <div class="card card-mfm mb-2">
        <div class="card-body py-2 d-flex justify-content-between align-items-center">
            <span>
                {{ player.name }}
                {% if player.role != 'player' %}<span class="badge bg-secondary ms-2">{{ player.get_role_display }}</span>{% endif %}
            </span>
            <div>
                <a href="{% url 'player_update' pk=player.pk %}" class="btn btn-mfm-secondary btn-sm">Edit</a>
                <a href="{% url 'player_delete' pk=player.pk %}" class="btn btn-mfm-danger btn-sm">Delete</a>
            </div>
        </div>
    </div>
    {% endfor %}
{% else %}
    <p class="text-muted mb-4">No players yet.</p>
{% endif %}

<!-- Opposition section -->
<div class="d-flex justify-content-between align-items-center mb-2 mt-4">
    <h2>Opposition Teams</h2>
    <a href="{% url 'opposition_create' club_pk=club.pk %}" class="btn btn-mfm-primary btn-sm">Add Opposition</a>
</div>

{% if club.oppositions.all %}
    {% for opp in club.oppositions.all %}
    <div class="card card-mfm mb-2">
        <div class="card-body py-2 d-flex justify-content-between align-items-center">
            <span>{{ opp.name }}</span>
            <div>
                <a href="{% url 'opposition_update' pk=opp.pk %}" class="btn btn-mfm-secondary btn-sm">Edit</a>
                <a href="{% url 'opposition_delete' pk=opp.pk %}" class="btn btn-mfm-danger btn-sm">Delete</a>
            </div>
        </div>
    </div>
    {% endfor %}
{% else %}
    <p class="text-muted mb-4">No opposition teams yet.</p>
{% endif %}

<!-- Matches section -->
<div class="d-flex justify-content-between align-items-center mb-2 mt-4">
    <h2>Matches</h2>
    <a href="{% url 'match_create' club_pk=club.pk %}" class="btn btn-mfm-primary btn-sm">Schedule Match</a>
</div>

{% if club.matches.all %}
    {% for match in club.matches.all %}
    <!-- Match card - mobile friendly -->
    <div class="card card-mfm mb-3">
        <div class="card-body">
            <!-- Match header: date and home/away badge -->
            <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="fw-bold">{{ match.date|date:"D d M" }}</span>
                <span class="badge {% if match.is_home %}bg-success{% else %}bg-secondary{% endif %}">
                    {% if match.is_home %}Home{% else %}Away{% endif %}
                </span>
            </div>
            <!-- Opposition name -->
            <h5 class="card-title mb-2">vs {{ match.opposition.name }}</h5>
            <!-- Match stats row -->
            <div class="d-flex justify-content-between text-muted mb-3">
                <span>Selected: {{ match.selected_count }}/11</span>
                <span>Available: {{ match.available_count }}</span>
                <span>{{ match.get_status_display }}</span>
            </div>
            <!-- Action button -->
            <a href="{% url 'match_detail' pk=match.pk %}" class="btn btn-mfm-primary btn-sm w-100">View Match</a>
        </div>
    </div>
    {% endfor %}
{% else %}
    <p class="text-muted">No matches scheduled.</p>
{% endif %}
{% endblock %}